<!-- Performance Optimization Scripts -->

<!-- Critical CSS -->
<style>
/* Critical CSS for above-the-fold content */
*{box-sizing:border-box}
html{font-display:swap;scroll-behavior:smooth}
body{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;line-height:1.6;background-color:var(--bg-color);color:var(--text-color);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility}
.header{background:var(--card-bg);border-bottom:1px solid var(--border-color);position:sticky;top:0;z-index:1000}
.navbar{padding:1rem 0}
.container{max-width:1200px;margin:0 auto;padding:0 15px}
.post-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:2rem}
.post-card{background:var(--card-bg);border-radius:8px;overflow:hidden;box-shadow:0 2px 10px rgba(0,0,0,.1);transition:transform .3s ease;contain:layout style paint;will-change:transform;transform:translateZ(0)}
.post-card:hover{transform:translateY(-5px)}
.post-card-image-wrapper{position:relative;width:100%;padding-top:56.25%;overflow:hidden;background-color:var(--card-bg)}
.post-card-image{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}
.post-card-content{padding:1.5rem}
.post-card-title{font-size:1.25rem;font-weight:600;margin-bottom:.5rem}
.post-card-excerpt{color:var(--text-color-secondary);font-size:.95rem;line-height:1.6}
.pagination-container{display:flex;justify-content:center;align-items:center;margin:3rem 0}
.pagination-wrapper{display:flex;align-items:center;gap:2rem;background:var(--card-bg);border-radius:12px;padding:1rem 2rem;box-shadow:0 4px 20px rgba(0,0,0,.08)}
.pagination-btn{display:flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;border-radius:8px;font-weight:600;text-decoration:none;transition:all .3s ease;background:var(--link-color);color:white;contain:layout style paint;will-change:transform;transform:translateZ(0)}
.pagination-btn:hover{transform:translateY(-3px)}
img{max-width:100%;height:auto;display:block}
img.lazy{opacity:0;transition:opacity .3s ease}
img.loaded{opacity:1}
@media(max-width:768px){body{font-size:16px}.post-grid{grid-template-columns:1fr;gap:1rem}.pagination-wrapper{flex-direction:column;gap:1rem}}
</style>

<!-- Preload key resources -->
<link rel="preload" href="{{ '/assets/css/main.css' | relative_url }}" as="style">
<link rel="preload" href="{{ '/assets/js/main.js' | relative_url }}" as="script">
<link rel="preload" href="{{ '/search.json' | relative_url }}" as="fetch" crossorigin>

<!-- DNS prefetch for external resources -->
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//fonts.gstatic.com">
<!-- DNS prefetch for ads removed -->

<!-- Preconnect for faster loading -->
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<!-- Performance monitoring -->
<script>
// Performance timing
window.performance = window.performance || {};
window.performance.mark = window.performance.mark || function() {};
window.performance.measure = window.performance.measure || function() {};
window.performance.mark('pageStart');

// Performance optimization initialization
window.performance.mark('pageStart');

// Lazy load non-critical resources
window.addEventListener('load', function() {
  window.performance.mark('pageLoaded');
  
  // Load non-critical CSS
  const mainCSS = document.createElement('link');
  mainCSS.rel = 'stylesheet';
  mainCSS.href = '{{ "/assets/css/main.css" | relative_url }}';
  document.head.appendChild(mainCSS);
  
  // Load performance script
  const perfScript = document.createElement('script');
  perfScript.src = '{{ "/assets/js/performance-boost.js" | relative_url }}';
  perfScript.async = true;
  document.body.appendChild(perfScript);
});
</script>

<!-- Resource hints for better performance -->
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="theme-color" content="#007bff">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<!-- Optimize for mobile performance -->
<meta name="format-detection" content="telephone=no">
<meta name="mobile-web-app-capable" content="yes">

<!-- Prefetch important pages -->
<link rel="prefetch" href="{{ '/' | relative_url }}">
<link rel="prefetch" href="{{ '/search/' | relative_url }}">
<link rel="prefetch" href="{{ '/categories/' | relative_url }}">
<link rel="prefetch" href="{{ '/tags/' | relative_url }}">